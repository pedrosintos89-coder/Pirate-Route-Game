<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>La Route des Corsaires</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #0d1a26;
            color: #e0f7fa;
            text-align: left;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #1a324a;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }
        h1 { color: #ffeb3b; border-bottom: 2px solid #00bcd4; padding-bottom: 10px; }
        .mission { margin-bottom: 20px; padding: 15px; border: 1px dashed #00bcd4; border-radius: 5px; }
        .score { font-size: 1.2em; color: #4caf50; font-weight: bold; }
        button { padding: 10px 20px; background-color: #4caf50; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px; }
        input { padding: 8px; margin: 5px 0; border: 1px solid #00bcd4; border-radius: 5px; width: 90%; background-color: #2b455e; color: #fff; }
    </style>
</head>
<body>

<div class="container">
    <h1>üè¥‚Äç‚ò†Ô∏è La Route des Corsaires üè¥‚Äç‚ò†Ô∏è</h1>
    <div id="game-output"></div>
    <div class="controls">
        <label for="strait-answer">Nom du D√©troit :</label>
        <input type="text" id="strait-answer" placeholder="Gibraltar"><br>
        <label for="nations-answer">Pays Contr√¥leurs (s√©par√©s par une virgule) :</label>
        <input type="text" id="nations-answer" placeholder="Espagne, Maroc, Royaume-Uni"><br>
        <button onclick="submitAnswer()">Confirmer la r√©ponse</button>
    </div>
</div>

<script>
    // 1. Donn√©es des Missions (GAME_DATA)
    const PIRATE_ROUTES_MISSIONS = [
        {
            id: 1,
            level: "Contr√¥le des D√©troits",
            start_port: "Abidjan (C√¥te d'Ivoire)",
            start_ocean: "Oc√©an Atlantique",
            challenge: "Entrez en M√©diterran√©e par la route la plus rapide.",
            target_strait: "D√©troit de Gibraltar",
            controlling_nations: ["Espagne", "Royaume-Uni (Gibraltar)", "Maroc"],
            point_value: 100
        },
        {
            id: 2,
            level: "Contr√¥le des D√©troits",
            start_port: "Djeddah (Arabie Saoudite)",
            start_ocean: "Mer Rouge",
            challenge: "Quittez la Mer Rouge en direction de l'Oc√©an Indien.",
            target_strait: "D√©troit de Bab el Mandeb",
            controlling_nations: ["Y√©men", "Djibouti", "√ârythr√©e"],
            point_value: 120
        },
        {
            id: 3,
            level: "Contr√¥le des D√©troits",
            start_port: "Singapour",
            start_ocean: "Mer de Chine M√©ridionale",
            challenge: "Atteindre l'Oc√©an Indien (Mer d'Andaman) sans passer par l'Indon√©sie.",
            target_strait: "D√©troit de Malacca",
            controlling_nations: ["Malaisie", "Indon√©sie", "Singapour"],
            point_value: 150
        },
        {
            id: 4,
            level: "Contr√¥le des D√©troits",
            start_port: "Constantinople (Istanbul)",
            start_ocean: "Mer Noire",
            challenge: "Quittez la Mer Noire par la route la plus rapide vers la Mer de Marmara.",
            target_strait: "D√©troit du Bosphore",
            controlling_nations: ["Turquie"],
            point_value: 90
        }
    ];

    // 2. Variables d'√©tat du jeu
    let currentMissionIndex = 0;
    let score = 0;
    const outputElement = document.getElementById('game-output');
    
    /**
     * Affiche la mission actuelle dans l'interface
     */
    function startNewMission() {
        if (currentMissionIndex < PIRATE_ROUTES_MISSIONS.length) {
            const mission = PIRATE_ROUTES_MISSIONS[currentMissionIndex];
            outputElement.innerHTML = `
                <p class="score">Score actuel : ${score}</p>
                <div class="mission">
                    <h3>Mission N¬∞ ${mission.id}: ${mission.level}</h3>
                    <p><strong>Point de d√©part :</strong> ${mission.start_port} (${mission.start_ocean})</p>
                    <p><strong>D√©fi :</strong> ${mission.challenge}</p>
                    <p>R√©pondez aux questions ci-dessous pour terminer la mission.</p>
                </div>
            `;
            // Effacer les champs de r√©ponse
            document.getElementById('strait-answer').value = '';
            document.getElementById('nations-answer').value = '';

        } else {
            outputElement.innerHTML = `
                <h2 style="color: #ffeb3b;">üéâ F√©licitations ! Le jeu est termin√©.</h2>
                <p class="score" style="font-size: 1.5em;">Score final total : ${score}</p>
                <p>Vous pouvez recharger la page pour recommencer.</p>
            `;
            // Cacher les contr√¥les
            document.querySelector('.controls').style.display = 'none';
        }
    }

    /**
     * Fonction de v√©rification de la r√©ponse du joueur
     */
    function submitAnswer() {
        if (currentMissionIndex >= PIRATE_ROUTES_MISSIONS.length) return;

        const mission = PIRATE_ROUTES_MISSIONS[currentMissionIndex];
        const straitAnswer = document.getElementById('strait-answer').value.trim();
        const nationsAnswerRaw = document.getElementById('nations-answer').value.trim();
        
        // Pr√©paration des r√©ponses pour la comparaison
        const providedNations = nationsAnswerRaw.split(',').map(n => n.trim().toLowerCase()).filter(n => n.length > 0);
        const requiredNations = mission.controlling_nations.map(n => n.toLowerCase());
        
        const isStraitCorrect = mission.target_strait.toLowerCase() === straitAnswer.toLowerCase();
        
        // V√©rification que les deux listes sont exactement les m√™mes
        const isNationsCorrect = requiredNations.every(req => providedNations.includes(req)) && 
                                providedNations.every(prov => requiredNations.includes(prov));


        if (isStraitCorrect && isNationsCorrect) {
            score += mission.point_value;
            outputElement.innerHTML += `<p style="color: #4caf50;">‚úÖ R√©ponse compl√®tement correcte ! Vous gagnez ${mission.point_value} points.</p>`;
            currentMissionIndex++;
            setTimeout(startNewMission, 1500); // Passer √† la mission suivante
        } else {
            let feedback = `<p style="color: #f44336;">‚ùå R√©ponse incorrecte. Veuillez r√©essayer.</p>`;
            if (!isStraitCorrect) {
                feedback += `<p style="color: #ff9800;">(Indice : V√©rifiez le nom du D√©troit)</p>`;
            }
            if (!isNationsCorrect) {
                feedback += `<p style="color: #ff9800;">(Indice : V√©rifiez la liste des Pays Contr√¥leurs)</p>`;
            }
            // Afficher le feedback sans effacer le contenu pr√©c√©dent
            outputElement.innerHTML = outputElement.innerHTML.split('<p style="color: #f44336;">')[0] + feedback;
        }
    }

    // Lancer le jeu au chargement de la page
    window.onload = startNewMission;

</script>
</body>
</html>
